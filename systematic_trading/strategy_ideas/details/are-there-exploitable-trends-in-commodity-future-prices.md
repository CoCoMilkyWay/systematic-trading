<div align="center">
  <h1>Are There Exploitable Trends in Commodity Future Prices?</h1>
</div>

## Original paper

ðŸ“• [Paper](https://papers.ssrn.com/sol3/papers.cfm?abstract_id=2565536)

## Trading rules

- Sort 35 commodity futures contracts into terciles based on prior month return
- Build an investment portfolio from the commodity futures with the highest past 6-months performance
- Time the momentum factor portfolio using a 5-day moving average
- Go long on the investment portfolio if its performance is over its 5-day moving average
- Do not invest if the performance of the investment portfolio is below its 5-day moving average
- Moving average could be profitably used as a market timing filter for various commodity portfolios sorted on volatility, volume, open interest and past performance
- Use 6-months past performance as an example to build the investment portfolio from commodity futures

## Statistics

- **Markets Traded:** Commodities, futures
- **Period of Rebalancing:** Daily
- **Backtest period:** 1974-2013
- **Annual Return:** 8.04%
- **Maximum Drawdown:** N/A
- **Sharpe Ratio:** 0.71
- **Annual Standard Deviation:** 11.3%

## Python code

### Backtrader

```python
import backtrader as bt

class TradingStrategy(bt.Strategy):
    def __init__(self):
        self.tercile_size = 35 // 3
        self.tercile_index = 0
        self.highest_perf_assets = []
        self.highest_perf_window = 6 * 30  # 6 months
        self.momentum_factor_days = 5
        self.tercile_assets = {}
        self.tercile_returns = {}
        self.asset_performance = {}

        # Define indicators
        self.tercile_return_indicator = self.feeds[0].close(-30).pct_change(periods=30)
        self.momentum_indicator = bt.indicators.SMA(self.highest_perf_assets[0].close, period=self.momentum_factor_days)

    def next(self):
        # Sort contracts into terciles based on prior month return
        if len(self.tercile_assets[self.tercile_index]) < self.tercile_size:
            self.tercile_assets[self.tercile_index].append(self.datas[0])
            self.asset_performance[self.datas[0]] = self.tercile_return_indicator[0]
            self.tercile_returns[self.tercile_index] += self.tercile_return_indicator[0]
        elif self.tercile_index < 2:
            self.tercile_index += 1
            self.tercile_assets[self.tercile_index].append(self.datas[0])
            self.asset_performance[self.datas[0]] = self.tercile_return_indicator[0]
            self.tercile_returns[self.tercile_index] += self.tercile_return_indicator[0]
        else:
            self.asset_performance[self.datas[0]] = self.tercile_return_indicator[0]
            if self.tercile_return_indicator[0] > min(self.tercile_returns.values()):
                min_index = list(self.tercile_returns.values()).index(min(self.tercile_returns.values()))
                self.tercile_assets[min_index].remove(self.highest_perf_assets[0])
                self.highest_perf_assets.remove(self.highest_perf_assets[0])
                self.tercile_assets[self.tercile_index].append(self.datas[0])
                self.highest_perf_assets.append(self.datas[0])
                self.tercile_returns[min_index] -= self.asset_performance[self.highest_perf_assets[0]]
                self.tercile_returns[self.tercile_index] += self.asset_performance[self.highest_perf_assets[0]]
                self.highest_perf_assets.sort(key=lambda x: self.asset_performance[x], reverse=True)

        # Build the investment portfolio from the commodity futures with the highest past 6-months performance
        if len(self.highest_perf_assets) != 35:
            self.highest_perf_assets.append(self.datas[0])
            self.highest_perf_assets.sort(key=lambda x: self.asset_performance[x], reverse=True)
        else:
            self.buy(self.highest_perf_assets)

        # Time the momentum factor portfolio using a 5-day moving average
        if len(self.highest_perf_assets) > 0:
            if self.highest_perf_assets[0].close[0] > self.momentum_indicator[0]:
                self.buy(self.highest_perf_assets)
            else:
                self.sell(self.highest_perf_assets)

        # Moving average could be used as a market timing filter for various commodity portfolios sorted on
        # volatility, volume, open interest and past performance
        for asset in self.highest_perf_assets:
            if asset.close[0] < bt.indicators.SMA(asset.close, period=self.momentum_factor_days):
                self.sell(asset)
```

Note: This code is intended for educational purposes only and is not meant to be used for actual trading.